{% extends "dashboard/layout.html" %}
{% load static %}

{% block title %}{{ profile.get_full_name }} - Profile{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'users/css/profile.css' %}?v=2">
{% endblock %}

{% block body %}

<!-- Profile section -->
<div class="profile-wrapper">
    <div class="profile-card">

        <!-- Banner + Profile Header Container -->
        <div class="profile-header-container">
            <div class="profile-banner"></div>

            <div class="profile-header-content">
                <div class="profile-picture-wrapper">
                    {% if profile.profile_picture %}
                    <img src="{{ profile.profile_picture.url }}" alt="{{ profile.username }}" class="profile-picture">
                    {% else %}
                    <div class="profile-avatar">
                        {{ profile.get_full_name|slice:":1" }}
                    </div>
                    {% endif %}
                </div>

                <div class="profile-info">
                    <h1 class="profile-name">{{ profile.get_full_name }}</h1>
                    <p class="profile-username">@{{ profile.username }}</p>
                    <span class="role-badge role-{{ profile.role }}">
                        {{ profile.role|title }}
                    </span>
                </div>
            </div>
        </div>

        <!-- Contact Information -->
        <div class="profile-body">
            <h2>Contact Information</h2>
            <p><strong>Email:</strong>
                <a href="mailto:{{ profile.email }}">{{ profile.email|default:"Not provided" }}</a>
            </p>

            <p><strong>Phone:</strong> {{ profile.default_phone|default:"Not provided" }}</p>

            <p><strong>Address:</strong> {{ profile.default_address|default:"Not provided" }}</p>

            <p><strong>Birthday:</strong> {{ profile.birthday|date:"M d, Y"|default:"N/A" }}</p>

        </div>

        <!-- Stats Section -->
        <div class="profile-section stats-grid">
            <div class="stat-box">
                <h3>{{ total_documents|default:0 }}</h3>
                <p>Documents</p>
            </div>
            <div class="stat-box">
                <h3>{{ profile.date_joined|date:"M Y" }}</h3>
                <p>Joined</p>
            </div>
        </div>
        <!-- Transaction History section -->
        <div class="transaction-history-wrapper">
            <div class="transaction-card"> {# same style as profile-card but isolated #}
                <h2>Transaction History</h2>

                {% if transactions %}
                <table class="transaction-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Reference</th>
                            <th>Amount</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for txn in transactions %}
                        <tr>
                            <td>{{ txn.date|date:"M d, Y" }}</td>
                            <td>{{ txn.reference }}</td>
                            <td>{{ txn.amount }}</td>
                            <td>{{ txn.status }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p>No transactions found.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}